# 餐饮管理系统
一个基于 Flask + MySQL 的餐饮点餐与餐厅运营管理系统，涵盖用户端点餐、订单、评价、桌位预订，以及管理员端的菜品、桌位与订单管理等功能。

## 项目简介

本项目实现了从“用户下单”到“餐厅后台管理”的完整闭环：

- 用户可注册登录、浏览菜单、加入购物车、下单、查看订单与详情、进行桌位预订与评论。
- 管理员可登录后台，进行菜品、桌位、订单与评论管理，并查看用户反馈。

## 主要特性

- 用户端
  - 安全注册登录、菜单浏览与搜索、购物车与下单、历史订单与详情
  - 桌位查询与预订、取消预订
  - 对餐厅进行评分与文字评价，查看所有评价

- 管理端
  - 菜品管理（增删改查、排序）
  - 桌位管理（增删改查、状态切换）
  - 订单管理（查看、更新状态）
  - 评论管理（查看与回复）

## 技术栈

- 后端：Flask（`app.py`）
- 数据库：MySQL（完整脚本见 `restaurant_db_complete.sql`）
- 前端：HTML5、CSS3、JavaScript、Jinja2 模板、AJAX
- 依赖管理：`requirements.txt`

## 项目结构

```
Restaurant-Ordering-System/
├─ app.py                      # Flask 应用主入口
├─ requirements.txt            # Python 依赖
├─ restaurant_db_complete.sql  # 数据库结构与初始化脚本
├─ templates/                  # 前端页面模板（含用户端与管理员端）
├─ static/                     # 前端静态资源（CSS、图片等）
├─ pic/                        # README 截图资源（请勿更改路径）
└─ README.md                   # 项目说明
```

## 快速开始

1) 环境准备

- 安装 Python 3.8+
- 安装并启动 MySQL 8.x（或兼容版本）

2) 初始化数据库

- 在 MySQL 中执行根目录下的脚本 `restaurant_db_complete.sql`
  - 将创建数据库 `restaurant_db` 以及项目所需的全部表与示例数据
  - 会插入一个管理员示例账号，见“默认账户”一节

3) 安装依赖

```bash
pip install -r requirements.txt
```

4) 配置数据库连接

- 在 `app.py` 中找到 `db_config` 段落（约第 32~38 行）：

```python
db_config = {
    'host': 'localhost',
    'user': 'root',
    'password': '123456',  # 根据实际情况修改密码
    'database': 'restaurant_db'
}
```

- 按照你的本地数据库配置修改 `user`、`password` 等字段。

5) 启动项目

```bash
python app.py
```

- 默认以开发模式启动，访问地址通常为 `http://127.0.0.1:5000/`

## 配置与运行

- 依赖版本见 `requirements.txt`：

```text
flask==2.0.1
mysql-connector-python==8.0.26
werkzeug==2.0.1
```

- 运行入口位于 `app.py` 末尾：

```python
if __name__ == '__main__':
    # 数据库初始化已通过restaurant_db_complete.sql完成
    app.run(debug=True)
```

## 默认账户

- 管理员（由数据库脚本插入）：
  - 用户名：`admin`
  - 密码：`123456`

- 说明：应用运行中也包含了用于初始化与演示的逻辑（如评论、菜品、桌位等初始化函数），但推荐以 `restaurant_db_complete.sql` 为主进行初始化。

## 安全与注意事项

- 生产环境请关闭 `debug=True`，并使用更安全的 `SECRET_KEY` 与数据库凭据。
- `app.py` 当前通过 `os.urandom(24)` 生成 `secret_key`，部署时建议改为环境变量注入。
- 默认管理员为演示用途，请及时修改默认密码并设置更严格的权限策略。

---

## 1. 需求分析

本小组为一家餐厅设计餐饮管理系统. 我们设计了用户(餐厅顾客)和管理员(餐厅经理)两个身份, 结合实际情况和需求设计了以下功能.

首先, 用户和管理员的身份必须严格区分开. 用户不能注册与管理员用户名相同的账号. 用户与管理员的访问权限也有差别, 只有管理员才有权限进行菜品和桌位的删除和管理操作.

### 用户的需求

1. 用户必须能安全地注册新用户, 并进行登录验证.
2. 管理系统首页展示餐厅名称, 推荐菜品, 餐厅评价, 地址电话号码等信息.
3. 用户点餐并查看历史点餐信息, 包括所点的菜品, 价格以及订单状态.
4. 桌位预订. 用户可选择空闲的桌位, 并选择就餐时间, 人数及备注, 并在同一界面看到所有的预订与其状态.
5. 评论. 用户可以对餐厅从多个方面进行评分(打星), 并提交文字评论, 并且能看到其他用户的所有评论.

### 管理员的需求

1. 菜品管理. 餐厅经理能够进行菜品的添加, 删除, 修改.
2. 桌位管理. 餐厅经理能够进行桌位的添加, 删除, 修改每张桌位能容纳的人数及其状态.
3. 订单管理. 餐厅经理能够看到完整的订单信息, 并且修改订单的状态.
4. 餐厅经理需要看到所有的预订信息, 并根据预订信息进行桌位管理.
5. 餐厅经理能够看到用户的所有评论, 能够对评论进行回复.

根据上述需求, 我们绘制了相应的E-R图如下:

![](./pic/pic1.png)

 ## 2. 技术实现

### 数据库设计

遵循 E-R 转换与 3NF 设计，核心表包括：`users`、`dishes`、`bulk_orders`、`order_details`、`tables`、`table_reservations`、`reviews`。完整字段与约束请参考根目录的 `restaurant_db_complete.sql`，该脚本亦会插入示例数据与管理员账号，便于快速体验。

#### 状态设计

- 订单：pending（待支付）/ preparing（准备中）/ completed（已完成）/ cancelled（已取消）
- 桌位：available（可用）/ reserved（已预订）/ occupied（使用中）

### 前端设计

- 使用 HTML5 + CSS3 + JavaScript + Jinja2 + AJAX 实现静态与动态内容渲染，支持响应式布局与无刷新交互。
- 页面分为用户端与管理员端，页面文件位于 `templates/`，静态资源位于 `static/`。

### 后端设计

- 基于 Flask，路由覆盖登录注册、菜单与菜品详情、购物车下单与订单详情、桌位预订、评价，以及管理员端的菜品/桌位/订单/评论管理。
- 使用装饰器进行登录态与管理员权限控制；数据库访问采用参数化查询，保障安全。

### 核心业务与 API

- 订单：创建主订单（`bulk_orders`）与子明细（`order_details`），计算金额并返回订单号。
- 预订：检查同一时间段冲突后创建记录并更新桌位状态。
- API 返回统一 JSON 格式，包含 `success`、`message` 与可选 `data` 字段；涉及多表写入时使用事务确保一致性。

 ## 3. 功能模块

### 1. 主页

- **餐厅主页**：展示餐厅的海报，下滑后依次展示”关于我们“、”推荐菜品“、”餐厅评价“等部分；

- **导航栏**：用户可以调整选择主页部分，或者查看菜单、桌位预订（需要登录或注册）；

- **餐厅信息**：最下方显示餐厅的营业时间、联系方式、地址等信息。


![](./pic/pic2.png)

![](./pic/pic3.png)

![](./pic/pic4.png)

![](./pic/pic5.png)

### 2. 登录注册模块

- **用户注册**：新用户可以通过提供用户名、密码和手机号码进行注册；
- **用户登录**：已注册用户可以使用用户名和密码登录系统；
- **管理员登录**：管理员可以使用特有的用户名登录系统，进入管理员操作页面。

![](./pic/pic6.png)

![](./pic/pic8.png)

### 3. 菜单模块

- **菜品浏览**：按分类展示菜品，包括主食、小食、饮品、沙拉和甜点等；
- **菜品搜索**：支持根据菜品名称进行搜索，也支持对不同种类菜品进行筛选；
- **菜品详情**：菜品展示了有关菜品的详细信息，包括图片、名称、价格和描述。

![](./pic/pic9.png)

### 4. 订单模块

- **购物车功能**：用户可以直接在菜品卡片上调整数量，在右上角的“购物车”部分看到自己选中的菜品及数量；
- **下单功能**：用户可以在“确认订单”页面选择就餐方式、支付方式并完成下单，完成下单后跳转“我的订单”；
- **订单查询**：在“我的订单”部分，用户可以查看自己的历史订单及详情，订单号后会显示当前订单状态。

![](./pic/pic10.png)

![](./pic/pic11.png)

![](./pic/pic12.png)

### 5. 桌位预订模块

- **桌位查询**：用户可以查看可用桌位及其详情（座位数、状态）；

- **进行预订**：用户可以选择预订日期、用餐时间、用餐人数等进行桌位预订；

- **预订管理**：用户可以查看所有预订，可以对预订进行取消操作。

![](./pic/pic13.png)

![](./pic/pic14.png)

![](./pic/pic15.png)

### 6. 评价模块

- **餐厅评价**：用户可以对餐厅进行评价，包括总体评分、菜品评分、环境评分和服务评分；
- **评价管理与展示**：用户可以查看所有评论，可以对自己的评价进行编辑或删除；

![](./pic/pic16.png)

![](./pic/pic17.png)

![](./pic/pic18.png)

### 7. 管理员模块

- **菜品管理**：可以添加、编辑和删除菜品；

![](./pic/pic19.png)

![](./pic/pic20.png)

- **桌位管理**：添加、编辑和删除桌位，更改不同桌位的使用状态；

![](./pic/pic21.png)

![](./pic/pic22.png)

- **订单管理**：查看所有订单，更新订单状态；

![](./pic/pic23.png)

- **预订管理**：查看和管理所有预订；

![](./pic/pic24.png)

- **评价管理**：查看和管理所有评价。

![](./pic/pic25.png)
